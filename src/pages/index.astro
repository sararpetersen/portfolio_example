---
const fetchCards = async () => {
  const response = await fetch("https://bbmabdbbjpfqoapbtstm.supabase.co/rest/v1/portfolio_cases?order=id.asc", {
    method: "GET",
    headers: {
      apikey:
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJibWFiZGJianBmcW9hcGJ0c3RtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI0NjkwNDYsImV4cCI6MjA1ODA0NTA0Nn0.gFnw6GZiMFOCMwy6rAcQFzoK0_qUJCwKNpl-XGzy574",
    },
  });
  return response.ok ? await response.json() : [];
};

const cards = await fetchCards();

function breakTitle(title, maxLength = 25) {
  if (title.length > maxLength) {
    const words = title.split(" ");
    let line = "";
    let lines = [];

    words.forEach((word) => {
      if ((line + " " + word).length <= maxLength) {
        line += " " + word;
      } else {
        lines.push(line.trim());
        line = word;
      }
    });

    lines.push(line.trim());
    return lines;
  }
  return [title];
}

import MainLayout from "../layouts/MainLayout.astro";
import "../styles/global.css";
import Button from "../components/Button.astro";
import Cases from "../components/Cases.astro";
---

<MainLayout
  title="SRP portfolio | Homepage"
  description="The frontpage of the portfolio"
  ogtitle="SRP portfolio - the portfolio of Sara Ringkow Petersen"
  ogdescription="A page for projects, information and other things about Sara"
>
  <!-- Hero Section -->
  <section class="hero-section grid grid-cols-12 md:pt-0 pt-mobil-top w-full h-screen md:px-0 px-4 relative">
    <div class="absolute inset-0 max-w-7xl mx-auto md:px-0 px-8 z-20 md:mt-0 mt-30">
      <div id="hero-content" class="grid grid-cols-12 items-center justify-center h-full">
        <!-- Text content -->
        <div class="col-span-12">
          <div id="status" class="md:mb-6 mb-4 flex items-center gap-2 justify-start text-sm">
            <span class="relative flex md:h-3.5 md:w-3.5 h-2.5 w-2.5" aria-hidden="true">
              <!-- soft pulse ring -->
              <span class="absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75 animate-ping"></span>

              <!-- solid dot -->
              <span class="relative inline-flex md:h-3.5 md:w-3.5 h-2.5 w-2.5 rounded-full bg-green-400"></span>
            </span>

            <strong class="text-gray-50 md:text-[1.2rem] text-[1rem]">Status:</strong><span class="text-gray-200 md:text-[1.2rem] text-[1rem]"
              >Open for internship</span
            >
          </div>
          <h1 class="text-gray-50 display pb-4">Sara Ringkow Petersen</h1>
          <h2 class="italic text-gray-50 md:text-[2.5rem] text-[1.3rem]">Multimedia Designer & Concept Developer</h2>
          <div class="space h-4"></div>
          <p class="text-gray-50 md:text-[1.4rem] text-[1rem] font-light pb-2 max-w-3xl leading-8">
            Passionate about creating accessible, user-centered digital experiences that blend design, development, and strategy
          </p>
        </div>
      </div>
    </div>

    <div class="hero_image w-full h-full absolute inset-0 z-0">
      <img src="/images/hero_image.webp" alt="Hero-image for the frontpage of the portfolio" class="w-full h-full object-cover grayscale" />
    </div>

    <div id="overlay1" class="absolute top-0 left-0 w-full h-full bg-gray-950 bg-opacity-[70%] z-0"></div>

    <div id="scroll-down" class="hidden md:block absolute bottom-[1%] md:bottom-[2.5%] left-[40%] w-auto items-center justify-center z-[20]">
      <a href="#project-section" aria-label="Go further down the page" class="focus:outline-none focus:ring-2 focus:ring-blue-300 scroll-link">
        <div class="float flex flex-col items-center transition duration-300 ease-in-out">
          <p class="text-[1.2rem] text-gray-50 font-bold">Go further down the page</p>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-8 h-8 sm:w-12 sm:h-12 text-gray-50 transition duration-300 ease-in-out scroll-icon"
          >
            <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path>
          </svg>
        </div>
      </a>
    </div>
  </section>

  <!-- Projects Section -->
  <section id="project-section" class="grid grid-cols-12 md:pt-desktop-top pt-mobil-top max-w-7xl mx-auto">
    <div class="container col-span-12">
      <h3 id="project-title" class="col-span-12 mb-2 text-gray-950 md:px-0 px-6">Projects</h3>
      <p id="project-text" class="col-span-12 text-gray-800 md:px-0 px-6 mb-8">
        Below are some of the projects I've worked on during my studies and internships. <br class="hidden md:block" />Click on any of the cards to
        read more about the project, the process and the outcome.
      </p>
    </div>
    <div class="col-span-12 md:px-0 px-6">
      <Cases projects={cards.sort((a, b) => new Date(b.created_at) - new Date(a.created_at))} />
    </div>
  </section>

  <!-- Intro Section: -->
  <section id="about-preview" class="max-w-7xl mx-auto md:pt-desktop-top pt-mobil-top md:pb-desktop-bottom pb-mobil-bottom relative px-6">
    <div class="grid md:grid-cols-2 gap-12 items-center md:px-0 px-6">
      <!-- Image -->
      <div class="flex md:justify-end justify-center md:order-1 order-2">
        <img src="/images/pfp3.webp" alt="Picture of Sara" class="border-r-4 border border-gray-200 rounded-2xl object-cover w-[550px] h-[350px]" />
      </div>

      <!-- Text -->
      <div id="about-preview-text">
        <h3 class="mb-4">About me</h3>

        <p
          class="mb-6 text-gray-800 max-w-4xl mx-auto md:mx-0 p-7 bg-gradient-to-br from-gray-50 to-gray-100 rounded-3xl border-l-4 border border-gray-200"
        >
          I'm a Multimedia Designer and Concept Developer with a strong focus on accessibility and user-centred design. I enjoy creating digital
          experiences that combine visual clarity, thoughtful structure, and functionality. My work spans UX/UI design, concept development, and
          coding, enabling me to take ideas from early concept to finished product. I'm especially motivated by designing solutions that are
          intuitive, inclusive, and meaningful for the people who use them.
        </p>

        <!-- Optional subtle link -->
        <div class="btn_container">
          <a aria-label="Learn more about me" id="about-preview-link" href="/about_me" class="mt-4">
            <Button variant="secondary" size="small">Learn more about me</Button>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Testimonials Section -->
  <section id="testimonials" class="grid grid-cols-12 max-w-7xl mx-auto md:pb-desktop-bottom pb-mobil-bottom px-6">
    <div class="container max-w-7xl mx-auto col-span-12 grid md:grid-cols-2 md:gap-10 gap-4 items-center justify-center md:px-0 px-6">
      <!-- Left: Heading + small context -->
      <div id="testimonial-heading">
        <h3 class="mb-2">Featured testimonial</h3>
        <p class="text-gray-800 leading-relaxed max-w-prose mx-auto md:mx-0">A short quote from someone I've worked with.</p>
      </div>

      <!-- Right: Testimonial card -->
      <figure id="testimonial-card" class="rounded-2xl bg-gradient-to-br from-gray-50 to-gray-100 rounded-3xl border-l-4 border border-gray-200 p-8">
        <blockquote>
          <p class="text-gray-800 italic">
            "Sara has shown consistent presence, where she has been fully involved in the daily operations of the agency. <em class="font-bold"
              >[...]</em
            > Both in team configurations and independently, Sara has demonstrated great responsibility and a strong desire to find solutions that meet
            the client's needs&mdash; this has been the case in both her work with design and coding."
          </p>
        </blockquote>

        <figcaption class="mt-6 flex items-center gap-4">
          <!-- Optional avatar circle (leave empty or add an image) -->
          <div class="h-12 w-12 rounded-full bg-gray-700/60 border border-gray-600 flex items-center justify-center">
            <span class="font-semibold text-sm">JK</span>
          </div>

          <div>
            <p class="font-semibold text-gray-700">Jacob Klintrup</p>
            <p class="text-gray-500 text-sm">Creative Strategic Director, Kadaver ApS</p>
          </div>
        </figcaption>
      </figure>
    </div>
  </section>

  <script>
    import { inView } from "motion";

    document.addEventListener("DOMContentLoaded", () => {
      const reduceMotion = document.body.classList.contains("reduce-motion");

      if (!reduceMotion) {
        const elementmedanimation1 = document.querySelector("#hero-content h1");
        inView(elementmedanimation1, () => {
          elementmedanimation1.classList.add("animate__animated", "animate__backInLeft");
        });

        const elementmedanimation6 = document.querySelector("#testimonial-heading h3");
        inView(elementmedanimation6, () => {
          elementmedanimation6.classList.add("animate__animated", "animate__backInLeft");
        });

        const elementmedanimation6a = document.querySelector("#testimonial-heading p");
        inView(elementmedanimation6a, () => {
          elementmedanimation6a.classList.add("animate__animated", "animate__fadeInRight");
        });

        const elementmedanimation7 = document.querySelector("#testimonial-card");
        inView(elementmedanimation7, () => {
          elementmedanimation7.classList.add("animate__animated", "animate__fadeInDown");
        });

        const elementmedanimation12 = document.querySelector("#scroll-down");
        inView(elementmedanimation12, () => {
          elementmedanimation12.classList.add("animate__animated", "animate__fadeInDown");
        });

        const elementmedanimation13 = document.querySelector("#project-section h3");
        inView(elementmedanimation13, () => {
          elementmedanimation13.classList.add("animate__animated", "animate__backInLeft");
        });

        const elementmedanimation14 = document.querySelector("#project-section p");
        inView(elementmedanimation14, () => {
          elementmedanimation14.classList.add("animate__animated", "animate__fadeInRight");
        });

        const elementmedanimation15 = document.querySelector("#hero-image img");
        inView(elementmedanimation15, () => {
          elementmedanimation15.classList.add("animate__animated", "animate__bounceInDown");
        });

        const elementmedanimation27 = document.querySelector("#hero-content h2");
        inView(elementmedanimation27, () => {
          elementmedanimation27.classList.add("animate__animated", "animate__fadeInDown");
        });

        const elementmedanimation28 = document.querySelector("#hero-content p");
        inView(elementmedanimation28, () => {
          elementmedanimation28.classList.add("animate__animated", "animate__fadeInUp");
        });

        const elementmedanimation29 = document.querySelector("#status");
        inView(elementmedanimation29, () => {
          elementmedanimation29.classList.add("animate__animated", "animate__fadeInDown");
        });

        const elementmedanimation30 = document.querySelector("#about-preview-text h3");
        inView(elementmedanimation30, () => {
          elementmedanimation30.classList.add("animate__animated", "animate__backInLeft");
        });

        const elementmedanimation31 = document.querySelector("#about-preview-text p");
        inView(elementmedanimation31, () => {
          elementmedanimation31.classList.add("animate__animated", "animate__fadeInRight");
        });

        const elementmedanimation32 = document.querySelector(".btn_container");
        inView(elementmedanimation32, () => {
          elementmedanimation32.classList.add("animate__animated", "animate__fadeInDown");
        });

        const elementmedanimation33 = document.querySelector("#about-preview img");
        inView(elementmedanimation33, () => {
          elementmedanimation33.classList.add("animate__animated", "animate__fadeInUp");
        });

        const intro1 = document.querySelectorAll("#intro-grid > div");

        intro1.forEach((intro1, index) => {
          inView(intro1, () => {
            intro1.classList.add("animate__animated", "animate__fadeInUp");
            intro1.style.animationDelay = `${index * 0.2}s`; // Delay each image by 0.2s
          });
        });
      }
    });
  </script>

  <style>
    /* Animations */
    @keyframes float {
      0% {
        transform: translatey(0);
      }
      50% {
        transform: translatey(-10px);
      }
      100% {
        transform: translatey(0);
      }
    }

    .float {
      animation: float 3s ease-in-out infinite;
    }

    @keyframes ping {
      75%,
      100% {
        transform: scale(2);
        opacity: 0;
      }
    }
    .animate-ping {
      animation: ping 2.5s cubic-bezier(0, 0, 0.2, 1) infinite;
    }

    /* Hero-section */
    .hero-title,
    .hero-subtitle,
    .hero-text {
      color: #f6f6f6;
    }

    /* Dark-mode */
    body.dark #portfolio-intro h3,
    body.dark #portfolio-intro p,
    body.dark #testimonials h3,
    body.dark #testimonials p,
    body.dark #testimonials blockquote,
    body.dark #testimonials blockquote em,
    body.dark #how-i-work p,
    body.dark #how-i-work h4,
    body.dark #project-section h3,
    body.dark #project-section p,
    body.dark #about-preview-text h3,
    body.dark #about-preview-text p {
      color: #f6f6f6;
    }

    body.dark #testimonials hr,
    body.dark #how-i-work hr,
    body.dark #more-about-me hr {
      border-color: #6d6d6d;
    }

    body.dark #process-cards div,
    body.dark #testimonials-cards blockquote,
    body.dark #intro-grid > div,
    body.dark #about-preview-text p,
    body.dark #testimonial-card {
      border-color: #6d6d6d;
      background: linear-gradient(to bottom right, #3a3a3a, #2d2d2d);
    }

    body.dark #about-preview img {
      border-color: #6d6d6d;
    }

    /* Miscellaneous */
    #hero-subtitle-text,
    #hero-text-content {
      display: inline-block;
    }

    body.dark .hero_image img {
      border-bottom: 1px solid #6d6d6d;
    }

    .scroll-link:hover .scroll-icon {
      color: #3a7cf7;
      transform: scale(1.1);
    }

    body.dark #process-cards div svg {
      color: #f6f6f6;
      background: transparent;
    }
  </style>
</MainLayout>
